import Io;
import Fs;

function main() : void {
    string path = Io.tempPath();
    string utf8_path = Io.tempPath();
    TextFile f = Io.openText(path, "w");
    f.write("abc");
    f.close();

    try {
        Io.openText(path, "x");
    } catch (InvalidModeException e) {
        Io.printLine("InvalidModeException");
    }

    try {
        Io.openText(path.concat("_missing"), "r");
    } catch (FileNotFoundException e) {
        Io.printLine("FileNotFoundException");
    }

    try {
        Io.openText(path.concat("/child"), "r");
    } catch (InvalidPathException e) {
        Io.printLine("InvalidPathException");
    }

    TextFile fc = Io.openText(path, "r");
    fc.close();
    try {
        fc.read(1);
    } catch (FileClosedException e) {
        Io.printLine("FileClosedException");
    }

    TextFile fr = Io.openText(path, "r");
    try {
        fr.read(0);
    } catch (InvalidArgumentException e) {
        Io.printLine("InvalidArgumentException");
    }
    fr.close();

    TextFile fg = Io.openText(path, "r");
    try {
        fg.seek(4);
    } catch (InvalidGlyphPositionException e) {
        Io.printLine("InvalidGlyphPositionException");
    }
    fg.close();

    BinaryFile bw = Io.openBinary(utf8_path, "w");
    list<byte> data = [0xC3.toByte(), 0x28.toByte()];
    bw.write(data);
    bw.close();

    TextFile fb = Io.openText(utf8_path, "r");
    try {
        fb.read(1);
    } catch (Utf8DecodeException e) {
        Io.printLine("Utf8DecodeException");
    }
    fb.close();

    try {
        Io.stdout.close();
    } catch (StandardStreamCloseException e) {
        Io.printLine("StandardStreamCloseException");
    }

    TextFile fw = Io.openText(path, "w");
    try {
        fw.read(1);
    } catch (ReadFailureException e) {
        Io.printLine("ReadFailureException");
    }
    fw.close();

    TextFile fr2 = Io.openText(path, "r");
    try {
        fr2.write("x");
    } catch (WriteFailureException e) {
        Io.printLine("WriteFailureException");
    }
    fr2.close();

    if (Fs.exists(path)) Fs.rm(path);
    if (Fs.exists(utf8_path)) Fs.rm(utf8_path);
}
